<!DOCTYPE html>
<html>
	<head>
		<title>Stuyvesant High School Junior Caucus</title>
		<link rel="stylesheet" href="index.css" type="text/css"/>
		<script type="text/javascript" src="https://cdn.jsdelivr.net/gh/leizongmin/js-xss/dist/xss.js"></script>
		<script type="text/javascript" src="opportunities.js"></script>
	</head>
	<body>
		<nav>
			<a href="index.html">HOME</a>
			<a href="about_us.html">ABOUT US</a>
			<a href="opportunities.html">OPPORTUNITIES</a>
			<a href="404.html">SCHOLARSHIPS</a>
			<a href="study_guides.html">ACADEMICS</a>
		</nav>
		<main>
			<h1>Academics</h1>
			<p>This page is for academic resources that might be useful to Juniors! Currently, we host study guides. You cann see the ones we have below, or submit one of your own to help out your fellow classmates. Good luck on your tests!</p>
			<div id="studyguides">Fetching study guides!</div>
			<h2>Submit your own guide</h2>
			<p>Use this form to submit your own study guide! It will be sent to us for approval, and if it is approved, you'll be able to see it in the table above. Please use the Bug Reports and Feedback link at the bottom of this page if you have any issues. Please note: while e-mails aren't displayed in the above table, they are still accessable by the general public.</p>
			<div id="formcontainer">
				<form action="https://shielded-reaches-80257.herokuapp.com/submit" method="POST">
					<label>
						Study Guide Name:<br/>
						<input type="text" name="title">
					</label><br/>
					<label>
						Study Guide Subject:<br/>
						<input type="text" name="subject">
					</label><br/>
					<label>
						Your Name:<br/>
						<input type="text" name="submittedBy">
					</label><br/>
					<label>
						Your Email:<br/>
						<input type="email" name="email">
					</label><br/>
					<label>
						Study Guide Link:<br/>
						<input type="url" name="link">
					</label><br/>
					<button type="submit">SUBMIT</button>
				</form>
			</div>
		<footer>
			Last Updated: 2021/01/11 | Junior Caucus IT | <a href="feedback.html">Bug Reports and Feedback</a>
		</footer>
<script>
	window.onload = function() {
		fetch("https://shielded-reaches-80257.herokuapp.com/guides")
			.then(res => res.json())
			.then(res => {
				const sgdiv = document.querySelector("#studyguides")
				sgdiv.innerHTML = ""
				const searchbar = document.createElement("input")
				searchbar.classList.add("search")
				searchbar.setAttribute("placeholder", "Search for a study guide")
				searchbar.id = "sgsearch"
				sgdiv.appendChild(searchbar)

				const table = document.createElement("table")
				table.id = "sgtable"
				table.classList.add("searchable_table")
				const header = document.createElement("tr")
				header.classList.add("header");
				["Title", "Subject", "Submitted By", "Link"].forEach(e => {
					const cell = document.createElement("th");
					cell.innerText = e
					header.appendChild(cell)
				})
				table.appendChild(header)

				res.forEach(guide => {
					const row = document.createElement("tr");
					["title", "subject", "submittedby", "link"].forEach(e => {
						const cell = document.createElement("td")
						cell.innerText = filterXSS(guide[e])
						row.appendChild(cell);
					})
					table.appendChild(row)
				})

				sgdiv.appendChild(table)
				//TODO: from opportunities.js, change code to not use IDs
				searchbar.addEventListener("keyup", () => filter("sgsearch", "sgtable"))
			})
	}
</script>
	</body>
</html>
